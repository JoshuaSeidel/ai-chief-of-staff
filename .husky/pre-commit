#!/bin/sh
echo "üì¶ Bumping version..."

# Run version bump script
node scripts/bump-version.js
VERSION_BUMP_EXIT_CODE=$?

if [ $VERSION_BUMP_EXIT_CODE -ne 0 ]; then
  echo "‚ùå Version bump failed. Please fix the issue before committing."
  exit 1
fi

# Stage the updated package.json files
git add backend/package.json frontend/package.json

echo "üîç Running ESLint on JavaScript files..."

# Check if we're in the frontend directory or root
if [ -d "frontend" ]; then
  cd frontend
  npm run lint -- --max-warnings=0
  LINT_EXIT_CODE=$?
  cd ..
else
  # If already in frontend directory
  npm run lint -- --max-warnings=0
  LINT_EXIT_CODE=$?
fi

if [ $LINT_EXIT_CODE -ne 0 ]; then
  echo "‚ùå ESLint found errors. Please fix them before committing."
  exit 1
fi

echo "‚úÖ ESLint passed!"

